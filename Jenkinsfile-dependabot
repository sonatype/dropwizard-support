#!groovy
library('private-pipeline-library')
library('jenkins-shared')

mavenOptions = []

mavenProfiles = [
  'zion'
]

mavenSnapshotPipeline(
  javaVersion: 'OpenJDK 11',
  useMvnw: true,
  usePublicSettingsXmlFile: true,
  useEventSpy: false,
  deployCondition: { false },
  mavenOptions: mavenOptions.join(' '),
  mavenProfiles: mavenProfiles,
  testResults: ['**/target/*-reports/*.xml'],
  runFeatureBranchPolicyEvaluations: true,
  iqPolicyEvaluation: { stage ->
    nexusPolicyEvaluation(
      iqStage: stage,
      iqApplication: 'dropwizard-support',
      failBuildOnNetworkError: true,
      iqScanPatterns: [
        [scanPattern: '**/target/sonatype-clm/module.xml']
      ]
    )
  },
  notificationSender: {
    notifyChat(currentBuild: currentBuild, env: env, room: 'ossindex-alerts')
  }
)
